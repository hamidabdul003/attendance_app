{% extends "base.html" %}

{% block title %}Rekap Kehadiran Bulanan{% endblock %}

{% block content %}
    <h1 class="text-center mt-4">Rekap Kehadiran Bulanan</h1>
    <h4 class="text-center mb-4">{{ month_name }} {{ year }}</h4>
    <form method="get" class="form-inline justify-content-center mb-4">
        <div class="form-group mr-2">
            <label for="year" class="mr-2">Tahun:</label>
            <select name="year" id="year" class="form-control">
                {% for y in range(2020, datetime.now().year + 1) %}
                    <option value="{{ y }}" {% if y == year %}selected{% endif %}>{{ y }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group mr-2">
            <label for="month" class="mr-2">Bulan:</label>
            <select name="month" id="month" class="form-control">
                {% for i in range(1, 13) %}
                    <option value="{{ i }}" {% if i == month %}selected{% endif %}>{{ calendar.month_name[i] }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Tampilkan</button>
    </form>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>No</th>
                <th>Nama</th>
                <th>Kelas</th>
                <th>Total Kehadiran</th>
            </tr>
        </thead>
        <tbody>
            {% for student in students %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ student.nama }}</td>
                <td>{{ student.kelas }}</td>
                <td>{{ totals[student.id] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="d-flex justify-content-center">
        <a href="{{ url_for('rekap_pdf', year=year, month=month) }}" class="btn btn-primary">Download PDF</a>
    </div>
{% endblock %}
